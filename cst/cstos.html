<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CST OS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }

        body {
            overflow: hidden;
            background: #000;
        }

        /* å¼€æœºåŠ¨ç”» */
        .boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s ease;
        }

        .boot-logo {
            font-size: 60px;
            font-weight: bold;
            color: #00ff00;
            margin-bottom: 30px;
            text-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00;
            animation: glitch 2s infinite, scanline 3s linear infinite;
        }

        .boot-progress {
            width: 400px;
            height: 6px;
            background: #333;
            border-radius: 3px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
        }

        .boot-progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #00ff00, #008000);
            transition: width 0.1s ease;
            box-shadow: 0 0 15px #00ff00;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-3px, 3px); }
            40% { transform: translate(-3px, -3px); }
            60% { transform: translate(3px, 3px); }
            80% { transform: translate(3px, -3px); }
            100% { transform: translate(0); }
        }

        @keyframes scanline {
            0% { text-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00; }
            50% { text-shadow: 0 0 30px #00ff00, 0 0 60px #00ff00; }
            100% { text-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00; }
        }

        /* ç™»å½•ç•Œé¢ */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 999;
        }

        .login-box {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 50px;
            width: 400px;
            box-shadow: 0 0 50px rgba(0, 255, 0, 0.3);
            border: 1px solid rgba(0, 255, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        .login-box::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(0, 255, 0, 0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: rotate(45deg) translateX(-100%); }
            100% { transform: rotate(45deg) translateX(100%); }
        }

        .login-title {
            text-align: center;
            color: #00ff00;
            margin-bottom: 40px;
            font-size: 32px;
            text-shadow: 0 0 10px #00ff00;
            position: relative;
            z-index: 1;
        }

        .login-input {
            width: 100%;
            padding: 15px;
            margin-bottom: 25px;
            border: 2px solid #00ff00;
            border-radius: 10px;
            background: rgba(0, 20, 0, 0.5);
            color: #00ff00;
            font-size: 18px;
            outline: none;
            transition: all 0.3s;
        }

        .login-input:focus {
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
            background: rgba(0, 30, 0, 0.7);
        }

        .login-input::placeholder {
            color: rgba(0, 255, 0, 0.7);
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #00ff00, #008000);
            color: #000;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            z-index: 1;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 25px rgba(0, 255, 0, 0.5);
        }

        .time-display {
            color: #00ff00;
            font-size: 16px;
            text-align: center;
            margin-top: 30px;
            text-shadow: 0 0 5px #00ff00;
            position: relative;
            z-index: 1;
        }

        /* ä¸»ç³»ç»Ÿç•Œé¢ */
        .desktop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff0080, #0080ff);
            display: none;
            flex-direction: column;
        }

        /* æ¡Œé¢å›¾æ ‡ */
        .desktop-icons {
            display: grid;
            grid-template-columns: repeat(auto-fill, 90px);
            gap: 25px;
            padding: 30px;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 15px;
            border-radius: 15px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .desktop-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .icon-img {
            width: 56px;
            height: 56px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            font-size: 28px;
            transition: all 0.3s;
        }

        .desktop-icon:hover .icon-img {
            transform: scale(1.1);
        }

        .icon-text {
            color: white;
            font-size: 13px;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        /* ä»»åŠ¡æ  */
        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            padding: 0 15px;
            z-index: 100;
            border-top: 1px solid rgba(0, 255, 0, 0.3);
        }

        .start-btn {
            background: linear-gradient(45deg, #00ff00, #008000);
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin-right: 15px;
            transition: all 0.3s;
        }

        .start-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.4);
        }

        .taskbar-buttons {
            display: flex;
            gap: 10px;
            flex: 1;
        }

        .taskbar-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .taskbar-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .taskbar-btn.active {
            background: rgba(0, 255, 0, 0.3);
            border-color: #00ff00;
        }

        .taskbar-time {
            color: #00ff00;
            margin-left: auto;
            font-size: 16px;
            padding: 0 15px;
            text-shadow: 0 0 5px #00ff00;
        }

        /* å¼€å§‹èœå• */
        .start-menu {
            position: fixed;
            bottom: 50px;
            left: 15px;
            width: 300px;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            padding: 15px;
            display: none;
            z-index: 101;
            border: 1px solid rgba(0, 255, 0, 0.3);
        }

        .menu-item {
            padding: 12px 15px;
            cursor: pointer;
            border-radius: 8px;
            margin-bottom: 8px;
            transition: all 0.3s;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
        }

        .menu-item:hover {
            background: rgba(0, 255, 0, 0.2);
            transform: translateX(5px);
        }

        /* çª—å£ */
        .window {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            min-width: 400px;
            min-height: 300px;
            display: none;
            flex-direction: column;
            z-index: 10;
            border: 1px solid rgba(0, 255, 0, 0.3);
        }

        .window-header {
            background: rgba(0, 255, 0, 0.1);
            padding: 15px;
            border-radius: 15px 15px 0 0;
            cursor: move;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0, 255, 0, 0.2);
        }

        .window-title {
            color: #00ff00;
            font-weight: bold;
            font-size: 16px;
            text-shadow: 0 0 5px #00ff00;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .window-btn {
            width: 25px;
            height: 25px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .close-btn {
            background: #ff5f57;
            color: white;
        }

        .minimize-btn {
            background: #ffbd2e;
            color: white;
        }

        .maximize-btn {
            background: #28c940;
            color: white;
        }

        .window-btn:hover {
            transform: scale(1.1);
        }

        .window-content {
            padding: 20px;
            flex: 1;
            overflow: auto;
            color: white;
        }

        /* æ–‡ä»¶ç®¡ç†å™¨ */
        .file-manager {
            width: 700px;
            height: 500px;
        }

        .file-toolbar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .file-btn {
            padding: 10px 15px;
            background: linear-gradient(45deg, #00ff00, #008000);
            color: #000;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .file-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 0, 0.4);
        }

        .file-list {
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            height: 350px;
            overflow: auto;
            background: rgba(0, 20, 0, 0.3);
        }

        .file-item {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .file-item.selected {
            background: rgba(0, 255, 0, 0.2);
            border-left: 3px solid #00ff00;
        }

        /* æ¸¸æˆæ ·å¼ */
        .game-container {
            width: 600px;
            height: 450px;
        }

        .game-area {
            width: 100%;
            height: 320px;
            background: #000;
            border-radius: 10px;
            margin-bottom: 15px;
            overflow: hidden;
            border: 1px solid rgba(0, 255, 0, 0.3);
        }

        .game-canvas {
            width: 100%;
            height: 100%;
        }

        .game-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .game-instructions {
            color: #aaa;
            font-size: 14px;
            text-align: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        /* è®¾ç½®çª—å£ */
        .settings-window {
            width: 500px;
            height: 400px;
        }

        .background-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .bg-option {
            width: 100px;
            height: 80px;
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .bg-option:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .bg-option.active {
            border-color: #00ff00;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }

        .bg-option span {
            position: absolute;
            bottom: 5px;
            left: 5px;
            color: white;
            font-size: 12px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .system-info {
            margin-top: 25px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .system-info h3 {
            color: #00ff00;
            margin-bottom: 10px;
            text-shadow: 0 0 5px #00ff00;
        }

        .system-info p {
            color: #ccc;
            font-size: 14px;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <!-- å¼€æœºåŠ¨ç”» -->
    <div class="boot-screen" id="bootScreen">
        <div class="boot-logo">CST OS</div>
        <div class="boot-progress">
            <div class="boot-progress-bar" id="progressBar"></div>
        </div>
    </div>

    <!-- ç™»å½•ç•Œé¢ -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <div class="login-title">CST OS ç™»å½•</div>
            <input type="text" class="login-input" placeholder="ç”¨æˆ·å" value="admin">
            <input type="password" class="login-input" placeholder="å¯†ç " value="123456">
            <button class="login-btn" onclick="login()">ç™»å½•ç³»ç»Ÿ</button>
            <div class="time-display" id="loginTime"></div>
        </div>
    </div>

    <!-- ä¸»æ¡Œé¢ -->
    <div class="desktop" id="desktop">
        <!-- æ¡Œé¢å›¾æ ‡ -->
        <div class="desktop-icons">
            <div class="desktop-icon" onclick="openFileManager()">
                <div class="icon-img">ğŸ“</div>
                <div class="icon-text">æ–‡ä»¶ç®¡ç†å™¨</div>
            </div>
            <div class="desktop-icon" onclick="openSnakeGame()">
                <div class="icon-img">ğŸ</div>
                <div class="icon-text">è´ªåƒè›‡</div>
            </div>
            <div class="desktop-icon" onclick="openShooterGame()">
                <div class="icon-img">ğŸ”«</div>
                <div class="icon-text">æªæˆ˜æ¸¸æˆ</div>
            </div>
            <div class="desktop-icon" onclick="openSettings()">
                <div class="icon-img">âš™ï¸</div>
                <div class="icon-text">ç³»ç»Ÿè®¾ç½®</div>
            </div>
        </div>

        <!-- ä»»åŠ¡æ  -->
        <div class="taskbar">
            <button class="start-btn" onclick="toggleStartMenu()">å¼€å§‹</button>
            <div class="taskbar-buttons" id="taskbarButtons">
                <!-- ä»»åŠ¡æ æŒ‰é’®å°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
            </div>
            <div class="taskbar-time" id="taskbarTime"></div>
        </div>

        <!-- å¼€å§‹èœå• -->
        <div class="start-menu" id="startMenu">
            <div class="menu-item" onclick="openFileManager()">ğŸ“ æ–‡ä»¶ç®¡ç†å™¨</div>
            <div class="menu-item" onclick="openSnakeGame()">ğŸ è´ªåƒè›‡</div>
            <div class="menu-item" onclick="openShooterGame()">ğŸ”« æªæˆ˜æ¸¸æˆ</div>
            <div class="menu-item" onclick="openSettings()">âš™ï¸ ç³»ç»Ÿè®¾ç½®</div>
            <div class="menu-item" onclick="logout()">ğŸšª æ³¨é”€ç³»ç»Ÿ</div>
        </div>

        <!-- æ–‡ä»¶ç®¡ç†å™¨çª—å£ -->
        <div class="window file-manager" id="fileManager" style="top: 100px; left: 100px;">
            <div class="window-header">
                <div class="window-title">ğŸ“ æ–‡ä»¶ç®¡ç†å™¨</div>
                <div class="window-controls">
                    <button class="window-btn minimize-btn" onclick="minimizeWindow('fileManager')">âˆ’</button>
                    <button class="window-btn maximize-btn" onclick="maximizeWindow('fileManager')">â–¡</button>
                    <button class="window-btn close-btn" onclick="closeWindow('fileManager')">Ã—</button>
                </div>
            </div>
            <div class="window-content">
                <div class="file-toolbar">
                    <button class="file-btn" onclick="createFile()">â• æ–°å»ºæ–‡ä»¶</button>
                    <button class="file-btn" onclick="deleteFile()">ğŸ—‘ï¸ åˆ é™¤æ–‡ä»¶</button>
                    <button class="file-btn" onclick="editFile()">âœï¸ ç¼–è¾‘æ–‡ä»¶</button>
                </div>
                <div class="file-list" id="fileList">
                    <div class="file-item" data-filename="æˆ‘çš„æ–‡æ¡£.txt">ğŸ“„ æˆ‘çš„æ–‡æ¡£.txt</div>
                    <div class="file-item" data-filename="é¡¹ç›®è®¡åˆ’.doc">ğŸ“ é¡¹ç›®è®¡åˆ’.doc</div>
                    <div class="file-item" data-filename="å­¦ä¹ ç¬”è®°.pdf">ğŸ“š å­¦ä¹ ç¬”è®°.pdf</div>
                    <div class="file-item" data-filename="ç…§ç‰‡.jpg">ğŸ–¼ï¸ ç…§ç‰‡.jpg</div>
                </div>
            </div>
        </div>

        <!-- è´ªåƒè›‡æ¸¸æˆçª—å£ -->
        <div class="window game-container" id="snakeGame" style="top: 150px; left: 200px;">
            <div class="window-header">
                <div class="window-title">ğŸ è´ªåƒè›‡æ¸¸æˆ</div>
                <div class="window-controls">
                    <button class="window-btn minimize-btn" onclick="minimizeWindow('snakeGame')">âˆ’</button>
                    <button class="window-btn maximize-btn" onclick="maximizeWindow('snakeGame')">â–¡</button>
                    <button class="window-btn close-btn" onclick="closeWindow('snakeGame')">Ã—</button>
                </div>
            </div>
            <div class="window-content">
                <div class="game-area">
                    <canvas class="game-canvas" id="snakeCanvas"></canvas>
                </div>
                <div class="game-controls">
                    <button class="file-btn" onclick="startSnakeGame()">â–¶ï¸ å¼€å§‹æ¸¸æˆ</button>
                    <button class="file-btn" onclick="stopSnakeGame()">â¹ï¸ åœæ­¢æ¸¸æˆ</button>
                    <span id="snakeScore">å¾—åˆ†: 0</span>
                </div>
                <div class="game-instructions">
                    ä½¿ç”¨æ–¹å‘é”®æ§åˆ¶è›‡çš„ç§»åŠ¨
                </div>
            </div>
        </div>

        <!-- æªæˆ˜æ¸¸æˆçª—å£ -->
        <div class="window game-container" id="shooterGame" style="top: 120px; left: 150px;">
            <div class="window-header">
                <div class="window-title">ğŸ”« æªæˆ˜æ¸¸æˆ</div>
                <div class="window-controls">
                    <button class="window-btn minimize-btn" onclick="minimizeWindow('shooterGame')">âˆ’</button>
                    <button class="window-btn maximize-btn" onclick="maximizeWindow('shooterGame')">â–¡</button>
                    <button class="window-btn close-btn" onclick="closeWindow('shooterGame')">Ã—</button>
                </div>
            </div>
            <div class="window-content">
                <div class="game-area">
                    <canvas class="game-canvas" id="shooterCanvas"></canvas>
                </div>
                <div class="game-controls">
                    <button class="file-btn" onclick="startShooterGame()">â–¶ï¸ å¼€å§‹æ¸¸æˆ</button>
                    <button class="file-btn" onclick="stopShooterGame()">â¹ï¸ åœæ­¢æ¸¸æˆ</button>
                    <span id="shooterScore">å¾—åˆ†: 0</span>
                </div>
                <div class="game-instructions">
                    ä½¿ç”¨é¼ æ ‡ç‚¹å‡»å°„å‡»æ•Œäººï¼ŒæŒ‰WASDç§»åŠ¨
                </div>
            </div>
        </div>

        <!-- è®¾ç½®çª—å£ -->
        <div class="window settings-window" id="settings" style="top: 200px; left: 300px;">
            <div class="window-header">
                <div class="window-title">âš™ï¸ ç³»ç»Ÿè®¾ç½®</div>
                <div class="window-controls">
                    <button class="window-btn minimize-btn" onclick="minimizeWindow('settings')">âˆ’</button>
                    <button class="window-btn maximize-btn" onclick="maximizeWindow('settings')">â–¡</button>
                    <button class="window-btn close-btn" onclick="closeWindow('settings')">Ã—</button>
                </div>
            </div>
            <div class="window-content">
                <h3>ğŸ¨ æ¡Œé¢èƒŒæ™¯è®¾ç½®</h3>
                <div class="background-selector">
                    <div class="bg-option active" style="background: linear-gradient(45deg, #ff0080, #0080ff);" onclick="changeBackground('default')">
                        <span>é»˜è®¤</span>
                    </div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff);" onclick="changeBackground('rainbow')">
                        <span>å½©è™¹</span>
                    </div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #87CEEB, #F0E68C);" onclick="changeBackground('beach')">
                        <span>æµ·æ»©</span>
                    </div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #667eea, #764ba2);" onclick="changeBackground('purple')">
                        <span>ç´«è‰²</span>
                    </div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #f093fb, #f5576c);" onclick="changeBackground('pink')">
                        <span>ç²‰è‰²</span>
                    </div>
                    <div class="bg-option" style="background: linear-gradient(45deg, #43e97b, #38f9d7);" onclick="changeBackground('green')">
                        <span>ç»¿è‰²</span>
                    </div>
                </div>
                <div class="system-info">
                    <h3>ğŸ’» ç³»ç»Ÿä¿¡æ¯</h3>
                    <p>æ“ä½œç³»ç»Ÿ: CST OS Ultimate Edition</p>
                    <p>ç‰ˆæœ¬: 2024.1.0</p>
                    <p>å†…æ ¸ç‰ˆæœ¬: 5.15.0-cst</p>
                    <p>æ¶æ„: x86_64</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let isLoggedIn = false;
        let isStartMenuOpen = false;
        let snakeGameInterval = null;
        let shooterGameInterval = null;
        let snake = [];
        let food = {};
        let direction = 'right';
        let snakeScore = 0;
        let player = { x: 50, y: 50 };
        let enemies = [];
        let bullets = [];
        let shooterScore = 0;
        let keys = {};
        let openWindows = [];

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            startBootAnimation();
            updateTime();
            setInterval(updateTime, 1000);
        });

        // æ›´æ–°æ—¶é—´æ˜¾ç¤º
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('zh-CN');
            if (document.getElementById('loginTime')) {
                document.getElementById('loginTime').textContent = timeString;
            }
            if (document.getElementById('taskbarTime')) {
                document.getElementById('taskbarTime').textContent = timeString;
            }
        }

        // å¼€æœºåŠ¨ç”»
        function startBootAnimation() {
            const progressBar = document.getElementById('progressBar');
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(() => {
                        document.getElementById('bootScreen').style.opacity = '0';
                        setTimeout(() => {
                            document.getElementById('bootScreen').style.display = 'none';
                            document.getElementById('loginScreen').style.display = 'flex';
                        }, 1000);
                    }, 500);
                }
                progressBar.style.width = progress + '%';
            }, 80);
        }

        // ç™»å½•ç³»ç»Ÿ
        function login() {
            isLoggedIn = true;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('desktop').style.display = 'flex';
        }

        // æ³¨é”€ç³»ç»Ÿ
        function logout() {
            isLoggedIn = false;
            document.getElementById('desktop').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
            closeAllWindows();
        }

        // åˆ‡æ¢å¼€å§‹èœå•
        function toggleStartMenu() {
            const menu = document.getElementById('startMenu');
            isStartMenuOpen = !isStartMenuOpen;
            menu.style.display = isStartMenuOpen ? 'block' : 'none';
        }

        // å…³é—­æ‰€æœ‰çª—å£
        function closeAllWindows() {
            const windows = document.querySelectorAll('.window');
            windows.forEach(window => {
                window.style.display = 'none';
            });
            openWindows = [];
            updateTaskbar();
            stopAllGames();
        }

        // åœæ­¢æ‰€æœ‰æ¸¸æˆ
        function stopAllGames() {
            if (snakeGameInterval) {
                clearInterval(snakeGameInterval);
                snakeGameInterval = null;
            }
            if (shooterGameInterval) {
                clearInterval(shooterGameInterval);
                shooterGameInterval = null;
            }
        }

        // æ›´æ–°ä»»åŠ¡æ 
        function updateTaskbar() {
            const taskbarButtons = document.getElementById('taskbarButtons');
            taskbarButtons.innerHTML = '';
            
            openWindows.forEach(windowId => {
                const button = document.createElement('button');
                button.className = 'taskbar-btn';
                button.onclick = () => showWindow(windowId);
                
                let title = '';
                switch(windowId) {
                    case 'fileManager': title = 'ğŸ“ æ–‡ä»¶ç®¡ç†å™¨'; break;
                    case 'snakeGame': title = 'ğŸ è´ªåƒè›‡'; break;
                    case 'shooterGame': title = 'ğŸ”« æªæˆ˜æ¸¸æˆ'; break;
                    case 'settings': title = 'âš™ï¸ è®¾ç½®'; break;
                }
                
                button.innerHTML = title;
                taskbarButtons.appendChild(button);
            });
        }

        // æ‰“å¼€åº”ç”¨ç¨‹åº
        function openFileManager() {
            document.getElementById('fileManager').style.display = 'flex';
            addToOpenWindows('fileManager');
            isStartMenuOpen = false;
            document.getElementById('startMenu').style.display = 'none';
        }

        function openSnakeGame() {
            document.getElementById('snakeGame').style.display = 'flex';
            addToOpenWindows('snakeGame');
            isStartMenuOpen = false;
            document.getElementById('startMenu').style.display = 'none';
        }

        function openShooterGame() {
            document.getElementById('shooterGame').style.display = 'flex';
            addToOpenWindows('shooterGame');
            isStartMenuOpen = false;
            document.getElementById('startMenu').style.display = 'none';
        }

        function openSettings() {
            document.getElementById('settings').style.display = 'flex';
            addToOpenWindows('settings');
            isStartMenuOpen = false;
            document.getElementById('startMenu').style.display = 'none';
        }

        function addToOpenWindows(windowId) {
            if (!openWindows.includes(windowId)) {
                openWindows.push(windowId);
                updateTaskbar();
            }
        }

        // çª—å£æ“ä½œ
        function closeWindow(id) {
            document.getElementById(id).style.display = 'none';
            openWindows = openWindows.filter(windowId => windowId !== id);
            updateTaskbar();
            if (id === 'snakeGame') stopSnakeGame();
            if (id === 'shooterGame') stopShooterGame();
        }

        function minimizeWindow(id) {
            document.getElementById(id).style.display = 'none';
        }

        function maximizeWindow(id) {
            const window = document.getElementById(id);
            if (window.style.width === '90vw') {
                window.style.width = '';
                window.style.height = '';
                window.style.top = '100px';
                window.style.left = '100px';
            } else {
                window.style.width = '90vw';
                window.style.height = '80vh';
                window.style.top = '10vh';
                window.style.left = '5vw';
            }
        }

        function showWindow(windowId) {
            document.getElementById(windowId).style.display = 'flex';
        }

        // æ–‡ä»¶ç®¡ç†å™¨åŠŸèƒ½
        function createFile() {
            const filename = prompt('è¯·è¾“å…¥æ–‡ä»¶å:');
            if (filename) {
                const fileList = document.getElementById('fileList');
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.setAttribute('data-filename', filename);
                fileItem.textContent = `ğŸ“„ ${filename}`;
                fileList.appendChild(fileItem);
            }
        }

        function deleteFile() {
            const selected = document.querySelector('.file-item.selected');
            if (selected) {
                if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ–‡ä»¶å—?')) {
                    selected.remove();
                }
            } else {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ–‡ä»¶');
            }
        }

        function editFile() {
            const selected = document.querySelector('.file-item.selected');
            if (selected) {
                const filename = selected.getAttribute('data-filename');
                const content = prompt(`ç¼–è¾‘æ–‡ä»¶ ${filename}:`, 'åœ¨æ­¤è¾“å…¥æ–‡ä»¶å†…å®¹...');
                if (content !== null) {
                    alert(`æ–‡ä»¶ ${filename} å·²ä¿å­˜`);
                }
            } else {
                alert('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ–‡ä»¶');
            }
        }

        // æ–‡ä»¶é€‰æ‹©
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('file-item')) {
                document.querySelectorAll('.file-item').forEach(item => {
                    item.classList.remove('selected');
                });
                e.target.classList.add('selected');
            }
        });

        // è´ªåƒè›‡æ¸¸æˆ
        function startSnakeGame() {
            const canvas = document.getElementById('snakeCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 560;
            canvas.height = 280;

            // åˆå§‹åŒ–æ¸¸æˆ
            snake = [
                {x: 150, y: 150},
                {x: 140, y: 150},
                {x: 130, y: 150}
            ];
            generateFood();
            direction = 'right';
            snakeScore = 0;
            document.getElementById('snakeScore').textContent = `å¾—åˆ†: ${snakeScore}`;

            // æ¸¸æˆå¾ªç¯
            if (snakeGameInterval) {
                clearInterval(snakeGameInterval);
            }
            snakeGameInterval = setInterval(() => {
                moveSnake();
                if (checkCollision()) {
                    clearInterval(snakeGameInterval);
                    snakeGameInterval = null;
                    alert(`æ¸¸æˆç»“æŸ! æœ€ç»ˆå¾—åˆ†: ${snakeScore}`);
                    return;
                }
                drawSnakeGame(ctx, canvas);
            }, 150);
        }

        function stopSnakeGame() {
            if (snakeGameInterval) {
                clearInterval(snakeGameInterval);
                snakeGameInterval = null;
            }
        }

        function moveSnake() {
            const head = {...snake[0]};
            
            switch(direction) {
                case 'up': head.y -= 10; break;
                case 'down': head.y += 10; break;
                case 'left': head.x -= 10; break;
                case 'right': head.x += 10; break;
            }
            
            snake.unshift(head);
            
            // æ£€æŸ¥æ˜¯å¦åƒåˆ°é£Ÿç‰©
            if (head.x === food.x && head.y === food.y) {
                snakeScore += 10;
                document.getElementById('snakeScore').textContent = `å¾—åˆ†: ${snakeScore}`;
                generateFood();
            } else {
                snake.pop();
            }
        }

        function checkCollision() {
            const head = snake[0];
            
            // æ£€æŸ¥è¾¹ç•Œç¢°æ’
            if (head.x < 0 || head.x >= 560 || head.y < 0 || head.y >= 280) {
                return true;
            }
            
            // æ£€æŸ¥è‡ªèº«ç¢°æ’
            for (let i = 1; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    return true;
                }
            }
            
            return false;
        }

        function generateFood() {
            food = {
                x: Math.floor(Math.random() * 56) * 10,
                y: Math.floor(Math.random() * 28) * 10
            };
        }

        function drawSnakeGame(ctx, canvas) {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶è›‡
            ctx.fillStyle = '#00ff00';
            snake.forEach((segment, index) => {
                if (index === 0) {
                    ctx.fillStyle = '#00cc00'; // è›‡å¤´é¢œè‰²æ›´æ·±
                } else {
                    ctx.fillStyle = '#00ff00';
                }
                ctx.fillRect(segment.x, segment.y, 10, 10);
            });
            
            // ç»˜åˆ¶é£Ÿç‰©
            ctx.fillStyle = '#ff0000';
            ctx.fillRect(food.x, food.y, 10, 10);
        }

        // é”®ç›˜æ§åˆ¶è´ªåƒè›‡
        document.addEventListener('keydown', function(e) {
            switch(e.key) {
                case 'ArrowUp':
                    if (direction !== 'down') direction = 'up';
                    break;
                case 'ArrowDown':
                    if (direction !== 'up') direction = 'down';
                    break;
                case 'ArrowLeft':
                    if (direction !== 'right') direction = 'left';
                    break;
                case 'ArrowRight':
                    if (direction !== 'left') direction = 'right';
                    break;
            }
        });

        // æªæˆ˜æ¸¸æˆ
        function startShooterGame() {
            const canvas = document.getElementById('shooterCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 560;
            canvas.height = 280;

            // åˆå§‹åŒ–æ¸¸æˆ
            player = { x: 50, y: 140 };
            enemies = [];
            bullets = [];
            shooterScore = 0;
            document.getElementById('shooterScore').textContent = `å¾—åˆ†: ${shooterScore}`;

            // ç”Ÿæˆæ•Œäºº
            for (let i = 0; i < 5; i++) {
                enemies.push({
                    x: Math.random() * 300 + 200,
                    y: Math.random() * 200 + 40,
                    speed: Math.random() * 2 + 1
                });
            }

            // æ¸¸æˆå¾ªç¯
            if (shooterGameInterval) {
                clearInterval(shooterGameInterval);
            }
            shooterGameInterval = setInterval(() => {
                updateShooterGame();
                drawShooterGame(ctx, canvas);
            }, 50);
        }

        function stopShooterGame() {
            if (shooterGameInterval) {
                clearInterval(shooterGameInterval);
                shooterGameInterval = null;
            }
        }

        function updateShooterGame() {
            // ç§»åŠ¨ç©å®¶
            if (keys['w'] && player.y > 10) player.y -= 3;
            if (keys['s'] && player.y < 270) player.y += 3;
            if (keys['a'] && player.x > 10) player.x -= 3;
            if (keys['d'] && player.x < 550) player.x += 3;

            // ç§»åŠ¨æ•Œäºº
            enemies.forEach(enemy => {
                enemy.x -= enemy.speed;
                if (enemy.x < 0) {
                    enemy.x = 560;
                    enemy.y = Math.random() * 200 + 40;
                }
            });

            // ç§»åŠ¨å­å¼¹
            for (let i = bullets.length - 1; i >= 0; i--) {
                bullets[i].x += 8;
                if (bullets[i].x > 560) {
                    bullets.splice(i, 1);
                }
            }

            // æ£€æŸ¥ç¢°æ’
            for (let i = bullets.length - 1; i >= 0; i--) {
                for (let j = enemies.length - 1; j >= 0; j--) {
                    const dx = bullets[i].x - enemies[j].x;
                    const dy = bullets[i].y - enemies[j].y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < 15) {
                        bullets.splice(i, 1);
                        enemies.splice(j, 1);
                        shooterScore += 10;
                        document.getElementById('shooterScore').textContent = `å¾—åˆ†: ${shooterScore}`;
                        
                        // ç”Ÿæˆæ–°æ•Œäºº
                        enemies.push({
                            x: 560,
                            y: Math.random() * 200 + 40,
                            speed: Math.random() * 2 + 1
                        });
                        break;
                    }
                }
            }
        }

        function drawShooterGame(ctx, canvas) {
            // æ¸…ç©ºç”»å¸ƒ
            ctx.fillStyle = '#1a1a2e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // ç»˜åˆ¶ç©å®¶
            ctx.fillStyle = '#00ff00';
            ctx.fillRect(player.x, player.y, 20, 20);

            // ç»˜åˆ¶æ•Œäºº
            ctx.fillStyle = '#ff0000';
            enemies.forEach(enemy => {
                ctx.fillRect(enemy.x, enemy.y, 15, 15);
            });

            // ç»˜åˆ¶å­å¼¹
            ctx.fillStyle = '#ffff00';
            bullets.forEach(bullet => {
                ctx.fillRect(bullet.x, bullet.y, 8, 4);
            });
        }

        // é”®ç›˜äº‹ä»¶ç›‘å¬
        document.addEventListener('keydown', function(e) {
            keys[e.key.toLowerCase()] = true;
        });

        document.addEventListener('keyup', function(e) {
            keys[e.key.toLowerCase()] = false;
        });

        // é¼ æ ‡ç‚¹å‡»å°„å‡»
        document.getElementById('shooterCanvas').addEventListener('click', function(e) {
            const canvas = document.getElementById('shooterCanvas');
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            bullets.push({
                x: player.x + 20,
                y: player.y + 10
            });
        });

        // æ›´æ”¹èƒŒæ™¯
        function changeBackground(type) {
            const desktop = document.getElementById('desktop');
            const options = document.querySelectorAll('.bg-option');
            
            options.forEach(option => option.classList.remove('active'));
            event.target.classList.add('active');
            
            switch(type) {
                case 'default':
                    desktop.style.background = 'linear-gradient(45deg, #ff0080, #0080ff)';
                    break;
                case 'rainbow':
                    desktop.style.background = 'linear-gradient(45deg, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff)';
                    break;
                case 'beach':
                    desktop.style.background = 'linear-gradient(45deg, #87CEEB, #F0E68C)';
                    break;
                case 'purple':
                    desktop.style.background = 'linear-gradient(45deg, #667eea, #764ba2)';
                    break;
                case 'pink':
                    desktop.style.background = 'linear-gradient(45deg, #f093fb, #f5576c)';
                    break;
                case 'green':
                    desktop.style.background = 'linear-gradient(45deg, #43e97b, #38f9d7)';
                    break;
            }
        }

        // çª—å£æ‹–æ‹½åŠŸèƒ½
        document.querySelectorAll('.window-header').forEach(header => {
            header.addEventListener('mousedown', function(e) {
                const window = this.parentElement;
                let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                
                e = e || window.event;
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
                
                function elementDrag(e) {
                    e = e || window.event;
                    e.preventDefault();
                    pos1 = pos3 - e.clientX;
                    pos2 = pos4 - e.clientY;
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                    window.style.top = (window.offsetTop - pos2) + "px";
                    window.style.left = (window.offsetLeft - pos1) + "px";
                }
                
                function closeDragElement() {
                    document.onmouseup = null;
                    document.onmousemove = null;
                }
            });
        });

        // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­å¼€å§‹èœå•
        document.addEventListener('click', function(e) {
            if (isStartMenuOpen && !e.target.closest('.start-btn') && !e.target.closest('.start-menu')) {
                isStartMenuOpen = false;
                document.getElementById('startMenu').style.display = 'none';
            }
        });
    </script>
</body>
</html>
